{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar React = require(\"react\");\n\nvar InteractionEvents;\n\n(function (InteractionEvents) {\n  InteractionEvents[\"MouseDown\"] = \"mousedown\";\n  InteractionEvents[\"MouseMove\"] = \"mousemove\";\n  InteractionEvents[\"MouseUp\"] = \"mouseup\";\n  InteractionEvents[\"TouchStart\"] = \"touchstart\";\n  InteractionEvents[\"TouchMove\"] = \"touchmove\";\n  InteractionEvents[\"TouchEnd\"] = \"touchend\";\n})(InteractionEvents || (InteractionEvents = {}));\n\nvar Joystick =\n/** @class */\nfunction (_super) {\n  __extends(Joystick, _super);\n\n  function Joystick(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.state = {\n      dragging: false\n    };\n    _this._stickRef = React.createRef();\n    _this._baseRef = React.createRef();\n\n    _this._throttleMoveCallback = function () {\n      var lastCall = 0;\n      return function (event) {\n        var now = new Date().getTime();\n        var throttleAmount = _this.props.throttle || 0;\n\n        if (now - lastCall < throttleAmount) {\n          return;\n        }\n\n        lastCall = now;\n\n        if (_this.props.move) {\n          return _this.props.move(event);\n        }\n      };\n    }();\n\n    _this._boundMouseUp = function () {\n      _this._mouseUp();\n    };\n\n    _this._boundMouseMove = function (event) {\n      _this._mouseMove(event);\n    };\n\n    return _this;\n  }\n\n  Joystick.prototype._updatePos = function (coordinates) {\n    var _this = this;\n\n    window.requestAnimationFrame(function () {\n      _this.setState({\n        coordinates: coordinates\n      });\n    });\n\n    this._throttleMoveCallback({\n      type: \"move\",\n      x: coordinates.relativeX,\n      y: -coordinates.relativeY,\n      direction: coordinates.direction\n    });\n  };\n\n  Joystick.prototype._mouseDown = function (e) {\n    if (this.props.disabled !== true) {\n      this._parentRect = this._baseRef.current.getBoundingClientRect();\n      this.setState({\n        dragging: true\n      });\n\n      if (e.type === InteractionEvents.MouseDown) {\n        window.addEventListener(InteractionEvents.MouseUp, this._boundMouseUp);\n        window.addEventListener(InteractionEvents.MouseMove, this._boundMouseMove);\n      } else {\n        window.addEventListener(InteractionEvents.TouchEnd, this._boundMouseUp);\n        window.addEventListener(InteractionEvents.TouchMove, this._boundMouseMove);\n      }\n\n      if (this.props.start) {\n        this.props.start({\n          type: \"start\",\n          x: null,\n          y: null,\n          direction: null\n        });\n      }\n    }\n  };\n\n  Joystick.prototype._getDirection = function (atan2) {\n    if (atan2 > 2.35619449 || atan2 < -2.35619449) {\n      return \"FORWARD\";\n    } else if (atan2 < 2.35619449 && atan2 > 0.785398163) {\n      return \"RIGHT\";\n    } else if (atan2 < -0.785398163) {\n      return \"LEFT\";\n    }\n\n    return \"BACKWARD\";\n  };\n\n  Joystick.prototype._getWithinBounds = function (value) {\n    var halfBaseSize = this._baseSize / 2;\n\n    if (value > halfBaseSize) {\n      return halfBaseSize;\n    }\n\n    if (value < -halfBaseSize) {\n      return halfBaseSize * -1;\n    }\n\n    return value;\n  };\n\n  Joystick.prototype._mouseMove = function (event) {\n    if (this.state.dragging) {\n      var absoluteX = null;\n      var absoluteY = null;\n\n      if (event.type === InteractionEvents.MouseMove) {\n        absoluteX = event.clientX;\n        absoluteY = event.clientY;\n      } else {\n        absoluteX = event.touches[0].clientX;\n        absoluteY = event.touches[0].clientY;\n      }\n\n      var relativeX = this._getWithinBounds(absoluteX - this._parentRect.left - this._baseSize / 2);\n\n      var relativeY = this._getWithinBounds(absoluteY - this._parentRect.top - this._baseSize / 2);\n\n      var atan2 = Math.atan2(relativeX, relativeY);\n\n      this._updatePos({\n        relativeX: relativeX,\n        relativeY: relativeY,\n        direction: this._getDirection(atan2),\n        axisX: absoluteX - this._parentRect.left,\n        axisY: absoluteY - this._parentRect.top\n      });\n    }\n  };\n\n  Joystick.prototype._mouseUp = function () {\n    this.setState({\n      dragging: false,\n      coordinates: undefined\n    });\n    window.removeEventListener(\"mouseup\", this._boundMouseUp);\n    window.removeEventListener(\"mousemove\", this._boundMouseMove);\n\n    if (this.props.stop) {\n      this.props.stop({\n        type: \"stop\",\n        x: null,\n        y: null,\n        direction: null\n      });\n    }\n  };\n\n  Joystick.prototype._getBaseStyle = function () {\n    var baseColor = this.props.baseColor !== undefined ? this.props.baseColor : \"#000033\";\n    var baseSizeString = this._baseSize + \"px\";\n    return {\n      height: baseSizeString,\n      width: baseSizeString,\n      background: baseColor,\n      borderRadius: this._baseSize,\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center'\n    };\n  };\n\n  Joystick.prototype._getStickStyle = function () {\n    var stickColor = this.props.stickColor !== undefined ? this.props.stickColor : \"#3D59AB\";\n    var stickSize = this._baseSize / 1.5 + \"px\";\n    var stickStyle = {\n      background: stickColor,\n      cursor: \"move\",\n      height: stickSize,\n      width: stickSize,\n      borderRadius: this._baseSize,\n      flexShrink: 0\n    };\n\n    if (this.state.dragging && this.state.coordinates !== undefined) {\n      stickStyle = Object.assign({}, stickStyle, {\n        position: 'absolute',\n        transform: \"translate3d(\" + this.state.coordinates.relativeX + \"px, \" + this.state.coordinates.relativeY + \"px, 0)\"\n      });\n    }\n\n    return stickStyle;\n  };\n\n  Joystick.prototype.render = function () {\n    this._baseSize = this.props.size || 100;\n\n    var baseStyle = this._getBaseStyle();\n\n    var stickStyle = this._getStickStyle();\n\n    return React.createElement(\"div\", {\n      className: this.props.disabled ? 'joystick-base-disabled' : '',\n      onMouseDown: this._mouseDown.bind(this),\n      onTouchStart: this._mouseDown.bind(this),\n      ref: this._baseRef,\n      style: baseStyle\n    }, React.createElement(\"div\", {\n      ref: this._stickRef,\n      className: this.props.disabled ? 'joystick-disabled' : '',\n      style: stickStyle\n    }));\n  };\n\n  return Joystick;\n}(React.Component);\n\nexports.Joystick = Joystick;","map":{"version":3,"mappings":"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","names":["InteractionEvents","__extends","props","_super","_this","state","dragging","_stickRef","React","createRef","_baseRef","_throttleMoveCallback","lastCall","event","now","Date","getTime","throttleAmount","throttle","move","_boundMouseUp","_mouseUp","_boundMouseMove","_mouseMove","Joystick","coordinates","window","requestAnimationFrame","setState","type","x","relativeX","y","relativeY","direction","e","disabled","_parentRect","current","getBoundingClientRect","MouseDown","addEventListener","MouseUp","MouseMove","TouchEnd","TouchMove","start","atan2","value","halfBaseSize","_baseSize","absoluteX","absoluteY","clientX","clientY","touches","_getWithinBounds","left","top","Math","_updatePos","_getDirection","axisX","axisY","undefined","removeEventListener","stop","baseColor","baseSizeString","height","width","background","borderRadius","display","justifyContent","alignItems","stickColor","stickSize","stickStyle","cursor","flexShrink","Object","assign","position","transform","size","baseStyle","_getBaseStyle","_getStickStyle","className","onMouseDown","_mouseDown","bind","onTouchStart","ref","style","Component","exports"],"sources":["../../src/Joystick.tsx"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}